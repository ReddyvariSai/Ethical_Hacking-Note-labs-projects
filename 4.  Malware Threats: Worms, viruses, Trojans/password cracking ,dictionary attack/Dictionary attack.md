# **Dictionary Attack: Complete Guide**

## **What is a Dictionary Attack?**

A **dictionary attack** is a password cracking method that tries words from a pre-compiled list of likely passwords, rather than trying every possible combination. It's like a thief trying every key on a keyring instead of trying millions of random keys.

## **Core Concept - Simple Analogy**

Imagine you're trying to guess someone's PIN:
- **Brute Force**: Try 0000, 0001, 0002... up to 9999 (10,000 attempts)
- **Dictionary Attack**: Try common PINs: 1234, 0000, 1111, 2580, 1212 (maybe 100 attempts)

The dictionary attack works because **people are predictable**.

---

## **How Dictionary Attacks Work - Step by Step**

### **Step 1: Gather Target Hashes**
```
Stored on server: d8578edf8458ce06fbc5bb76a58c5ca4  (hash of "qwerty")
Stored on server: 5f4dcc3b5aa765d61d8327deb882cf99  (hash of "password")
```

### **Step 2: Load Wordlist**
```
passwords.txt:
--------------
password
123456
qwerty
letmein
welcome
iloveyou
admin
...
```

### **Step 3: Hash Each Word & Compare**
```python
# Simplified Python Example
import hashlib

def dictionary_attack(target_hash, wordlist_file):
    with open(wordlist_file, 'r', encoding='utf-8', errors='ignore') as f:
        for word in f:
            word = word.strip()  # Remove newline
            
            # Hash the word (using same algorithm)
            hashed_word = hashlib.md5(word.encode()).hexdigest()
            
            # Compare with target
            if hashed_word == target_hash:
                print(f"PASSWORD FOUND: {word}")
                return word
    
    print("Password not found in dictionary")
    return None

# Example usage
target = "d8578edf8458ce06fbc5bb76a58c5ca4"  # Hash of "qwerty"
dictionary_attack(target, "passwords.txt")
```

---

## **Types of Dictionary Attacks**

### **1. Basic Dictionary Attack**
- Tries words exactly as they appear in the list
- Fastest but least effective for complex passwords

### **2. Hybrid Dictionary Attack**
- Adds common modifications to dictionary words
- Examples: `password → Password1`, `summer → Summer2024!`

**Common Modifications:**
- Add numbers at end (0-9, 00-99, 000-999)
- Capitalize first letter
- Add special characters (!, @, #, $)
- Reverse the word (`drowssap`)
- Leetspeak substitution (`password → p@ssw0rd`)

### **3. Rules-Based Dictionary Attack**
- Applies transformation rules to each word
- Much more powerful than basic attacks

**John the Ripper Rules Example:**
```
# Common rule sets
:s      # Try the word as-is
:c      # Capitalize first letter: password → Password
:r      # Reverse: password → drowssap
$1 $2   # Append numbers 1 and 2: password → password12
^! ^@   # Prepend ! and @: password → !password
```

### **4. Targeted Dictionary Attack**
- Creates custom wordlists based on target information
- Uses OSINT (Open Source Intelligence)

**Information Sources for Custom Lists:**
- Social media profiles
- Company name, products
- Pet names, family members
- Sports teams, hobbies
- Previous breaches (if same username elsewhere)

---

## **Popular Wordlists & Their Contents**

### **1. RockYou.txt** (14 million passwords)
- From 2009 RockYou data breach
- Real passwords from 32 million users
- **Most common passwords in RockYou:**
```
1. 123456
2. 12345
3. 123456789
4. password
5. iloveyou
6. princess
7. 1234567
8. rockyou
9. 12345678
10. abc123
```

### **2. Common Passwords Lists**
```
# Top 10 most common passwords (2024)
1. 123456
2. admin
3. 12345678
4. 123456789
5. 1234
6. 12345
7. password
8. 123
9. Aa123456
10. 1234567890
```

### **3. Specialized Wordlists**
- **Names**: 10K most common first/last names
- **Sports**: Team names, player names, championships
- **Geographic**: Cities, countries, landmarks
- **Seasonal**: `Summer2024!`, `Winter2023#`
- **Company-specific**: `CompanyName2024`, `Product123`

---

## **Tools for Dictionary Attacks**

### **1. Hashcat (GPU-Powered)**
```bash
# Basic dictionary attack
hashcat -m 0 -a 0 target_hashes.txt rockyou.txt

# Dictionary attack with rules
hashcat -m 0 -a 0 target_hashes.txt wordlist.txt -r rules/best64.rule

# Hybrid attack (word + 2 digits)
hashcat -m 0 -a 6 target_hashes.txt wordlist.txt ?d?d
```

### **2. John the Ripper**
```bash
# Simple dictionary attack
john --wordlist=rockyou.txt hashes.txt

# With word mangling rules
john --wordlist=passwords.txt --rules hashes.txt

# Show cracked passwords
john --show hashes.txt
```

### **3. Custom Wordlist Generation Tools**

**Crunch** (Pattern-based):
```bash
# Generate 8-char passwords: 6 letters + 2 digits
crunch 8 8 -t @@@@@@%% -o wordlist.txt

# @ = lowercase letters
# % = digits
# , = uppercase letters
# ^ = special characters
```

**Cewl** (Website scraper):
```bash
# Create wordlist from website content
cewl https://target-company.com -d 2 -m 5 -w company_words.txt
# -d = depth to spider
# -m = minimum word length
```

---

## **Success Rates & Statistics**

### **Real-World Success Rates**
- **Basic dictionary**: 10-20% of passwords
- **With rules**: 30-50% of passwords
- **Targeted attack**: Up to 70% for specific individuals

### **Why So Effective?**
```
Analysis of 10 million leaked passwords:
• 17% contained a person's name
• 12% used a month + year (January2024)
• 9% were just dictionary words
• 23% used common patterns (qwerty, 123456)
• Only 41% were "random enough" to resist dictionary attacks
```

### **Time to Crack with Dictionary Attack**
| **Hardware** | **Passwords/Second** | **Time for 14M (RockYou)** |
|--------------|---------------------|----------------------------|
| Home CPU | 100,000 | 2.3 minutes |
| Gaming GPU | 10,000,000 | 1.4 seconds |
| 8x GPU Rig | 1,000,000,000 | 0.014 seconds |

*Note: This is JUST for hash comparison. Actual time depends on hash algorithm.*

---

## **Defeating Dictionary Attacks**

### **For Users: Choose Better Passwords**

**BAD Passwords** (easily cracked):
```
password123
Summer2024
JohnSmith1975
iloveyou
qwertyuiop
```

**GOOD Passwords** (resist dictionary attacks):
```
CorrectHorseBatteryStaple  (passphrase)
7B#pL9@x$qR2!vN  (random)
PurpleElephantDancesAtMidnight42!
```

**Password Strength Test:**
```
"password123"      → Cracked instantly
"P@ssw0rd!"        → Cracked in < 1 second (rules apply)
"Tr0ub4dor&3"      → Cracked in ~3 hours (still guessable)
"CorrectHorseBatteryStaple" → Years to crack
```

### **For System Administrators**

#### **1. Implement Password Policies**
```bash
# Linux: /etc/pam.d/common-password
password requisite pam_pwquality.so retry=3 \
minlen=12 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1 \
minclass=3 reject_username enforce_for_root
```

#### **2. Use Strong Hash Algorithms**
```python
# WEAK: Fast hashes (easy to test many)
import hashlib
hash = hashlib.md5(password + salt).hexdigest()  # BAD

# STRONG: Slow hashes (resource-intensive)
import bcrypt
hash = bcrypt.hashpw(password.encode(), bcrypt.gensalt(rounds=12))  # GOOD

# Even better: Memory-hard algorithms
import argon2
hash = argon2.hash_password(password.encode())
```

#### **3. Add Salt AND Pepper**
```python
# Salt (unique per user, stored in DB)
salt = os.urandom(32)  # 256-bit random

# Pepper (global secret, NOT in DB)
pepper = b"my-secret-pepper-key-2024"

# Combined
hash = argon2.hash_password(password.encode() + salt + pepper)
```

#### **4. Rate Limiting & Account Lockout**
```python
# Example: Django settings
AUTH_PASSWORD_VALIDATORS = [
    {'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator'},
    {'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator'},  # ← Blocks dictionary words!
]

# Account lockout after failed attempts
AXES_FAILURE_LIMIT = 5
AXES_COOLOFF_TIME = '0.5'  # 30 minutes
```

---

## **Advanced Dictionary Attack Techniques**

### **1. Password Spraying**
- Tries FEW passwords against MANY accounts
- Avoids lockout policies
- Example: Try `Spring2024!` against 10,000 users

### **2. Time-Memory Tradeoff (Rainbow Tables)**
- Pre-computed hash chains
- Faster than dictionary attacks for unsalted hashes
- **But**: Defeated by salting

### **3. Keyboard Walk Patterns**
```
# Common keyboard patterns
qwertyuiop
1qaz2wsx3edc
zaq12wsx
!qaz@wsx#edc
```

### **4. Context-Aware Attacks**
```python
# Generate passwords based on target info
def generate_targeted_words(username, company, birth_year):
    words = []
    
    # Basic combinations
    words.append(username + "123")
    words.append(company.lower() + "2024")
    words.append(username + birth_year)
    
    # Common substitutions
    words.append(username.replace('o', '0').replace('i', '1'))
    
    return words

# Example output for user "john1985@acme.com":
# john123, acme2024, john1985, j0hn1985, J0hn1985!
```

---

## **Ethical Use & Legal Considerations**

### **Legal Uses:**
- Testing **your own** systems
- Authorized penetration testing
- Academic research
- Recovering **your own** forgotten passwords

### **Illegal Uses:**
- Accessing systems without permission
- Testing others' websites/applications
- Sharing or using cracked credentials
- Commercial password recovery without consent

**Always get written authorization!**

---

## **Quick Defense Checklist**

### **For End Users:**
✅ Use password managers
✅ Enable 2FA/MFA everywhere
✅ Use passphrases (4+ random words)
✅ Check haveibeenpwned.com regularly
✅ Never reuse passwords

### **For Developers:**
✅ Use bcrypt/Argon2 (not MD5/SHA-1)
✅ Implement proper salting
✅ Add rate limiting
✅ Use password strength meters
✅ Block common passwords

### **For Admins:**
✅ Regular password audits
✅ Enable account lockout policies
✅ Monitor failed login attempts
✅ Educate users on password hygiene
✅ Implement password expiration (carefully)

---

## **The Bottom Line**

Dictionary attacks work because **human behavior is predictable**. The most effective defense isn't just complexity—it's **unpredictability**.

**Remember**: A 12-character password using common patterns (`Summer2024!`) is weaker than a 20-character passphrase (`BlueHorsesJumpOverRedMountains!`) against dictionary attacks.

The best passwords are:
1. **Long** (16+ characters)
2. **Unpredictable** (not based on personal info)
3. **Unique** (different for every site)
4. **Protected** (with 2FA when available)
